package org.example.u2;

import AcercaDe;
import android.app.TabActivity;
import android.content.Intent;
import android.os.Bundle;
import android.util.DisplayMetrics;
import android.view.View;
import android.widget.EditText;
import android.widget.TabHost;
import android.widget.TextView;
import android.widget.Toast;

public class BeltranJL_U2Activity extends TabActivity {

	private EditText cantidadEuros;
	private TextView resulPesetas;
	private Integer  contador = 0; 
	private TextView calculadora;
	private int flag = 0;
	int iH=70;
	Float height;
	Float wwidth;
	DisplayMetrics displaymetrics;
	Double diagonal;
    int padding_tab=20;

	@Override
	public void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		setContentView(R.layout.main);

		TabHost tabHost = getTabHost();                
		tabHost.addTab(tabHost.newTabSpec("tab1").setIndicator(this.getString(R.string.actividadAsteroides), null).setContent(R.id.tabAsteroides));
		tabHost.addTab(tabHost.newTabSpec("tab2").setIndicator(this.getString(R.string.conversor), null).setContent(R.id.tabConversor));
		tabHost.addTab(tabHost.newTabSpec("tab3").setIndicator(this.getString(R.string.calculadora), null).setContent(R.id.tabCalculadora));

		// Detecto qué clase de dispositivo se trata:
	    displaymetrics = new DisplayMetrics();
        getWindowManager().getDefaultDisplay().getMetrics(displaymetrics);
        height =(float) displaymetrics.heightPixels/displaymetrics.densityDpi; 
        wwidth = (float) displaymetrics.widthPixels/displaymetrics.densityDpi;
        diagonal=Math.sqrt((Math.pow((double)height, 2))+(Math.pow((double)wwidth, 2))); 
      
        if (diagonal<3.5){iH=45;padding_tab=13;} // Dispositivo Small
        
		
	
				
		for (int i = 0; i < tabHost.getTabWidget().getChildCount(); i++) {
			tabHost.getTabWidget().getChildAt(i).getLayoutParams().height = iH;
			tabHost.getTabWidget().getChildAt(i).setPadding(0, 0, 0, padding_tab);
		
		}   


		cantidadEuros = (EditText) findViewById(R.id.textCantidadEuros);
		resulPesetas  = (TextView) findViewById(R.id.textResultadoConversion);
		calculadora   = (TextView) findViewById(R.id.editCalculadora);
	}

	public void euro2peseta(View view) {    	
		try {
			Float resul = (float) (Float.parseFloat(cantidadEuros.getText().toString())*166.386);
			resulPesetas.setText(resul.toString()+" pesetas");
		} catch(Exception e) {
			Toast.makeText(this, "Introduce una cantidad", Toast.LENGTH_SHORT).show();
		}    	
	}

	public void calcular(View view) {
		// No uso estructura switch porque no permite switch(String) antes de la version 1.7

		String teclaPulsada = view.getTag().toString();

		if(teclaPulsada.equals("C")) { // Limpiar
			contador = 0;
			calculadora.setText("0"); 

		} else if (teclaPulsada.equals("I")) { // Igual
			contador += Integer.parseInt(calculadora.getText().toString());
			calculadora.setText(contador.toString());
			contador = 0;
		} else if (teclaPulsada.equals("M")) { // Sumar
			contador += (int) Float.parseFloat(calculadora.getText().toString());
			flag = 1;
		} else { // 0-9
			if(flag == 0) { // Concatenar en pantalla
				Integer num = Integer.parseInt(calculadora.getText().toString() + teclaPulsada);
				calculadora.setText(num.toString());

			} else { 
				calculadora.setText(teclaPulsada);
				flag=0;
			}
		}

	}
	
	
	public void lanzarAcercaDe(View view){
		Intent i =new Intent(this, AcercaDe.class);
		startActivity(i);
	}
}